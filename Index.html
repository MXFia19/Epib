<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Convertisseur Cloud Mobile</title>
    <style>
        /* Un design propre et moderne pour mobile */
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            background-color: #eef2f5;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
            margin: 0;
            padding: 20px;
        }

        .card {
            background: white;
            padding: 2rem;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            width: 100%;
            max-width: 350px;
            text-align: center;
        }

        h2 { margin-top: 0; color: #2c3e50; }
        
        .upload-area {
            border: 2px dashed #cbd5e0;
            border-radius: 12px;
            padding: 30px 20px;
            margin: 20px 0;
            background: #f8fafc;
            cursor: pointer;
            transition: all 0.3s;
        }

        .upload-area.active {
            border-color: #3498db;
            background: #ebf8ff;
        }

        /* Masquer l'input file moche */
        #fileInput { display: none; }

        .btn {
            background: #3498db;
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 50px;
            font-size: 16px;
            font-weight: bold;
            width: 100%;
            cursor: pointer;
            box-shadow: 0 4px 6px rgba(52, 152, 219, 0.3);
            transition: transform 0.1s;
        }

        .btn:active { transform: scale(0.98); }
        .btn:disabled { background: #bdc3c7; box-shadow: none; }

        #status { margin-top: 20px; font-size: 14px; min-height: 20px; color: #7f8c8d; }

        .download-link {
            display: inline-block;
            margin-top: 15px;
            color: #27ae60;
            text-decoration: none;
            font-weight: bold;
            border: 2px solid #27ae60;
            padding: 10px 20px;
            border-radius: 50px;
        }
    </style>
</head>
<body>

<div class="card">
    <h2>‚ö° Convertisseur Rapide</h2>
    <p>Transforme tes EPUB en PDF gr√¢ce au Cloud.</p>

    <div class="upload-area" id="dropZone" onclick="document.getElementById('fileInput').click()">
        <span style="font-size: 40px;">üìö</span>
        <p id="fileName">Touche ici pour choisir un fichier</p>
    </div>
    
    <input type="file" id="fileInput" accept=".epub">

    <button class="btn" id="convertBtn" onclick="convertir()" disabled>Convertir</button>
    
    <div id="status"></div>
</div>

<script>
    // --- CONFIGURATION ---
    // 1. Va sur https://www.convertapi.com/ (Inscription gratuite)
    // 2. Copie ta "Secret Key" et colle-la ci-dessous entre les guillemets
    const API_SECRET = 'd2ITJqf65NNhFvJwHCFmHI3G5YYBrHuv'; 
    // ---------------------

    const fileInput = document.getElementById('fileInput');
    const fileName = document.getElementById('fileName');
    const dropZone = document.getElementById('dropZone');
    const btn = document.getElementById('convertBtn');
    const status = document.getElementById('status');

    // Quand on choisit un fichier
    fileInput.addEventListener('change', function() {
        if (this.files[0]) {
            fileName.innerText = this.files[0].name;
            dropZone.classList.add('active');
            btn.disabled = false; // On active le bouton
            status.innerHTML = "";
        }
    });

    async function convertir() {
        // V√©rification basique
        if (API_SECRET === 'TA_CLE_SECRETE_ICI') {
            alert("Oups ! Tu as oubli√© de mettre ta cl√© API dans le code (ligne 86).");
            return;
        }

        const file = fileInput.files[0];
        if (!file) return;

        // UI : Chargement
        btn.disabled = true;
        btn.innerText = "Envoi et conversion...";
        status.innerText = "Patience, la magie op√®re ‚òÅÔ∏è...";

        try {
            // Pr√©paration des donn√©es pour l'API
            let formData = new FormData();
            formData.append('File', file);
            formData.append('StoreFile', 'true'); // Stocker temporairement pour g√©n√©rer un lien

            // Appel √† l'API (Fetch)
            let response = await fetch(`https://v2.convertapi.com/convert/epub/to/pdf?Secret=${API_SECRET}`, {
                method: 'POST',
                body: formData
            });

            let result = await response.json();

            if (result.Files && result.Files.length > 0) {
                // SUCC√àS
                let pdfUrl = result.Files[0].Url;
                
                status.innerHTML = "";
                btn.innerText = "Termin√© !";
                
                // Afficher le bouton de t√©l√©chargement
                let link = document.createElement('a');
                link.href = pdfUrl;
                link.className = 'download-link';
                link.innerText = "‚¨áÔ∏è T√©l√©charger le PDF";
                status.appendChild(link);
                
            } else {
                throw new Error(result.Message || "Erreur inconnue de l'API");
            }

        } catch (error) {
            console.error(error);
            status.innerText = "‚ùå Erreur : " + error.message;
            status.style.color = "red";
            btn.disabled = false;
            btn.innerText = "R√©essayer";
        }
    }
</script>

</body>
</html>
